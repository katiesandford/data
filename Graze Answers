Graze

1. How many customers signed up on the week starting 15th Oct 2012?
Query:
    SELECT COUNT(*) FROM `account` WHERE signup_date BETWEEN '2012-10-15' AND '2012-10-21'
Answer:
    10960

2. What is the total revenue from account 1856619? 

Query:
	SELECT SUM(price) FROM `box` WHERE account_id=1856619
Answer:
	529.98

3. How many customers have received at least 15 boxes?

QUERY:
	SELECT COUNT(*) FROM (SELECT COUNT(*) as box_count  FROM box GROUP BY account_id) AS aggregate_table  WHERE box_count  >= 15
ANSWER:
	13624

4. How many customers have never received a box? 

QUERY:
	SELECT DISTINCT COUNT(*)  FROM account LEFT OUTER JOIN box ON account.id=box.account_id WHERE delivery_date IS null
ANSWER:
	1888

5. How many different products have been sent? 

QUERY:
	SELECT COUNT(*) FROM ((SELECT product1 from box) UNION (SELECT product2 FROM box) UNION (SELECT product3 FROM box) UNION (SELECT product4 FROM box)) AS allproducts
ANSWER:
	165

6. Rank the name of the top 3 promotions for the week starting 22nd Oct 2012 (in terms 

of signups) 

7. Generate a result set with the following column headings, for all boxes that were 

delivered on 26th Jan 2013: 

Box ID Account ID Promotion ID 

8. What is the average time between signup and cancellation (in days)? 

9. What is the average time between signup and a first box (in days)? 

10.

a. How many customers are still active (haven’t cancelled the service)? 

b. (optional) How many customers were active (haven’t cancelled the service) at 

11. Explain what this query does, and write down a possible use you can imagine for it: 

SELECT 

 signup_date, 

 promotion_id, 

 FLOOR(DATEDIFF(cancelled_date, signup_date) / 7) week, 

 COUNT(DISTINCT account.id) numCancellations 

FROM account 

WHERE cancelled_date IS NOT NULL 

GROUP BY signup_date, promotion_id, week; 

the end of every week [from the first sign-up week in the data set]?